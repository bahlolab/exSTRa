## After running exSTRa_score_analysis.R

expected_text <- "SCA1 (coding CAG) norm: 30 (91bp) , exp: 39 (117bp)"

test_that("text info has changed", {
  expect_equal(loci_text_info(exstra_wgs_pcr_2, "SCA1"), expected_text)
  expect_equal(loci_text_info(exstra_known, "SCA1"), expected_text)
})

# Check if stats have changed between runs
signif_t4 <- rep(FALSE, 72L)
signif_t4[c(6L, 8L, 25L, 27L, 47L, 49L, 57L, 58L)] <- TRUE
tsum_4_stat_expected <- structure(
  list(locus = rep(c("FRDA", "HD", "SCA1", "SCA6"), each = 18L), 
       sample = rep(exstra_wgs_pcr_2[c("FRDA", "HD", "SCA1", "SCA6")]$samples$sample, 4), 
       tsum = c(0.224380249148273, 2.37758148162023, -1.07940061758087, 
                1.57425576258927, -0.798785508384082, 12.1568724547556, -0.0499542968581375, 
                13.6084534900895, -0.948799603576648, 0.574070399992865, 1.63576022357892, 
                -1.03104591457042, -1.0749926804585, -0.829945459178228, 0.259554736873429, 
                -1.00755996690811, -1.24996212368913, 0.420927049807855, 0.786516641820349, 
                -1.172794941291, 0.723720010512832, -1.69374057764295, 0.390300040933457, 
                0.428491742832125, 3.91108896876089, -0.609890992015034, 4.76740654909031, 
                -1.23399805696571, -0.916004064537924, 0.957603674028104, 0.659459559963802, 
                -2.02905299666637, -0.533057564727455, 1.38595972765822, 0.405403842170188, 
                -2.5587545946545, -1.43821871246616, -0.59558400236103, 0.405922698653123, 
                -1.0752105450191, 1.57536587945526, 0.387789477505747, -1.21780862564997, 
                -1.41822767936836, 0.65656345823473, 1.22467714174923, 7.78112378457968, 
                -0.652290506303217, 5.76156014714232, -0.0290817911882959, 0.397476263167401, 
                -1.77027753218897, -0.816579341867959, 0.952616543908046, -3.79937114162863, 
                -0.0789628643300572, 8.8769255799246, 9.00122725995872, -0.681222999573219, 
                -0.779015147584197, 0.899801731700652, -0.772331414419086, 0.5460126810212, 
                -0.161137617130204, -0.789583335376947, 1.52409422969287, 0.551143835964604, 
                0.884747680441177, -0.776298245817875, -2.32054394165983, 1.57876816389141, 
                -4.16169382240489), 
       p.value = c(0.424678863370961, 0.0235222154256798, 
                   0.825390646721904, 0.0891397430906968, 0.757381971862314, 5.56080742923873e-05, 
                   0.521937385308347, 5.56080742923873e-05, 0.794528165489629, 0.310348662625813, 
                   0.0814658288383473, 0.815158761052105, 0.824612133681811, 0.765611966857588, 
                   0.412500695100929, 0.809486737474281, 0.858922315520214, 0.359005727631652, 
                   0.235222154256798, 0.861813935383418, 0.253517210698993, 0.941166657398654, 
                   0.36245342823778, 0.349107490407607, 0.000444864594339098, 0.713340377022744, 
                   5.56080742923873e-05, 0.87443696824779, 0.801812823221932, 0.189345492965579, 
                   0.273591725518545, 0.966190290830229, 0.688984040482678, 0.100150141800589, 
                   0.356058499694156, 0.9890452093644, 0.954512595228827, 0.7582160929767, 
                   0.314741700494912, 0.893677361952956, 0.0299727520435967, 0.322916087415893, 
                   0.922093087916365, 0.953011177222933, 0.214424734471445, 0.0721792804315187, 
                   5.56080742923873e-05, 0.777901351276205, 5.56080742923873e-05, 
                   0.516599010176278, 0.318745481843964, 0.980092309403325, 0.831229494522605, 
                   0.12439526219207, 0.99977756770283, 0.530945893343714, 5.56080742923873e-05, 
                   5.56080742923873e-05, 0.746649613523884, 0.77567702830451, 0.193960963131847, 
                   0.773452705332814, 0.299227047767336, 0.560974253461603, 0.77823499972196, 
                   0.0685091475282211, 0.297725629761441, 0.197631096035144, 0.774842907190124, 
                   0.986042373352611, 0.0622254351331813, 1), 
       p.value.sd = c(0.00371933750409938, 
                      0.00114035906525819, 0.00285688427700108, 0.00214404450792662, 
                      0.00322573296645405, 5.61083995687615e-05, 0.00375868596036027, 
                      5.61083995687615e-05, 0.00304053041416414, 0.00348109832234763, 
                      0.00205829451712071, 0.00292109556454543, 0.00286189335209305, 
                      0.0031877426211819, 0.00370421067817689, 0.00295522618519211, 
                      0.0026197023943587, 0.00360957172114026, 0.00319140241647488, 
                      0.00259708734231943, 0.00327332272894612, 0.00177138353859604, 
                      0.00361709636676319, 0.0035868386527749, 0.000158667629074313, 
                      0.00340277536635413, 5.61083995687615e-05, 0.0024937434125611, 
                      0.00299981882969808, 0.0029479443840595, 0.00335442069001875, 
                      0.00136104996419164, 0.00348332642964443, 0.00225882822939046, 
                      0.00360297883495368, 0.000785214098825476, 0.00156879148376772, 
                      0.00322195719221135, 0.00349446720684997, 0.00231994437549771, 
                      0.00128300008502451, 0.00351838190724261, 0.00201739919942113, 
                      0.00159318594575569, 0.00308820217181155, 0.00194719879320345, 
                      5.61083995687615e-05, 0.00312787434243812, 5.61083995687615e-05, 
                      0.00376023265228794, 0.00350633571719554, 0.00105249314554967, 
                      0.00281864452647277, 0.00248329746756226, 0.00012567399521793, 
                      0.003755100336517, 5.61083995687615e-05, 5.61083995687615e-05, 
                      0.00327285269291166, 0.00313899676170731, 0.00297515221188393, 
                      0.00314999099012397, 0.00344560402425578, 0.00373424831326973, 
                      0.00312619483871966, 0.00190079600721531, 0.00344062832120107, 
                      0.00299632377160518, 0.00314313454713603, 0.000884486579626783, 
                      0.00181762814712978, 5.66115672688022e-05), 
       B = rep(999, 72L), 
       signif = signif_t4
       ), 
  class = "data.frame", 
  row.names = c(NA, 
                -72L))

test_that("tsum_test()$stats table has changed from previous runs.", {
  expect_equal(as.data.frame(tsum_4$stats), tsum_4_stat_expected)
})
